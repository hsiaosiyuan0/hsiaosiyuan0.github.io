<!DOCTYPE html>
<html lang="en-us">
  <head>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
    <link rel="manifest" href="/images/site.webmanifest">

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <title>加密算法调研 | hsiaosiyuan</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link rel="stylesheet" href="http://hsiaosiyuan0.github.io/css/theme-override.css">
    <header>

  <nav>
    <ul>
      
      
      <li class="pull-left ">
        <a href="http://hsiaosiyuan0.github.io/">~/hsiaosiyuan</a>
      </li>
      

      

    </ul>
  </nav>
</header>

  </head>

  <body>
    <br/>

<div class="article-meta">
<h1><span class="title">加密算法调研</span></h1>

<h2 class="date">2019/06/13</h2>
<p class="terms">
  
  
  
  
  
</p>
</div>


<div class="content-wrapper">
  <main>
    <h1 id="加密算法调研">加密算法调研</h1>
<p>需求需要对数据进行加解密，所以需要对一些常见加密算法做一些调研。</p>
<h2 id="对称加密">对称加密</h2>
<p>对称加密 <a href="https://en.wikipedia.org/wiki/Symmetric-key_algorithm">Symmetric-key algorithms</a> 有如下几个特点：</p>
<ol>
<li>使用相同的密匙进行加解密</li>
<li>加解密速度相比非对称加密要快</li>
<li>对 plaintext 的大小理论上没有限制</li>
<li>加密后的密文大小的增幅不大</li>
</ol>
<h2 id="非对称加密">非对称加密</h2>
<p>非对称加密 <a href="https://en.wikipedia.org/wiki/Public-key_cryptography">Public-key cryptography, or asymmetric cryptography</a> 有如下几个特点</p>
<ol>
<li>使用一个公私匙对进行加解密</li>
<li>加密速度相比对称加密要慢很多</li>
<li>在特定情况下，对 plaintext 的大小有限制</li>
<li>加密后的密文大小的增幅很大</li>
</ol>
<p>常见的非对称加密算法有：</p>
<ol>
<li>RSA (HTTPS 中使用)</li>
<li>ECDSA (<a href="https://en.bitcoin.it/wiki/How_bitcoin_works">Bitcoin 中使用</a>)</li>
</ol>
<p>RSA 和 ECDSA 的比较可以参考 <a href="https://equaleyes.com/blog/2018/04/06/ecdsa-and-rsa-algorithms/">ECDSA and RSA</a>，简单的来说 ECDSA 有如下几个优点</p>
<ol>
<li>在与 RSA 达到相同加密程度下的 key 尺寸更小 见 <a href="https://wiki.openssl.org/index.php/Elliptic_Curve_Cryptography">Elliptic_Curve_Cryptography</a></li>
<li>在与 RSA 达到相同加密程度下的 key 生成更快</li>
<li>加解密比 RSA 快点</li>
</ol>
<p><em>RSA 的加密程度与 key 的大小成正比。</em></p>
<h2 id="几个引用">几个引用</h2>
<h3 id="ref1">ref1</h3>
<p><a href="https://security.stackexchange.com/questions/33434/rsa-maximum-bytes-to-encrypt-comparison-to-aes-in-terms-of-security#answer-33445">RSA maximum bytes to encrypt, comparison to AES in terms of security?
</a></p>
<p>主要说明非对称加密算法之一的 RSA 在某些情况下对 plaintext 的大小是有限制的。</p>
<p>另外说明了非对称加密的通常使用方式是做 <a href="https://en.wikipedia.org/wiki/Public-key_cryptography#Enveloped_Public_Key_Encryption">Enveloped Encryption</a></p>
<h3 id="ref2">ref2</h3>
<p><a href="https://crypto.stackexchange.com/questions/5782/why-is-asymmetric-cryptography-bad-for-huge-data#answer-5790">Why is asymmetric cryptography bad for huge data</a></p>
<p>主要说明非对称加密会消耗更对的空间来存储密文，比明文高出 49%。</p>
<p>相比非对称加密更慢消耗更多的性能，这点在移动设备上应该更为突出。</p>
<p>其中的一条补充应该是对 ref1 中:</p>
<blockquote>
<p>the maximum size of data which can be encrypted with RSA is 245 bytes. No more.</p>
</blockquote>
<p>的补充，所以我感觉用 “特性情况” 下对 plaintext 的大小有限制这样来表述比较准确。</p>
<p>另一条补充强调了任何的 public-key encryption 都会导致密文大小变大。</p>
<h2 id="小结">小结</h2>
<p>所以为了达到一个性能和安全性通用的程度，我们还是应该采取常见的 Enveloped Encryption 方式。</p>
<p>为了达到贴合 Bitcoin 的目的，可以使用 ECDSA 配合 AES 来对数据加密，具体的加密步骤如下：</p>
<ol>
<li>随机生成密匙 AK 用于 AES 加密</li>
<li>对数据 Data 使用 AK 进行 AES 加密得到 AES(Data)</li>
<li>使用 ECDSA 公钥对 AK 进行加密得到 ECDSA(AK)</li>
<li>将 ECDSA(AK) 和 AES(Data) 写入文件，即为加密文件</li>
</ol>
<p>对于每个文件的加密，都执行上述步骤，即每次的 AK 不同。</p>
<p>具体的解密步骤如下：</p>
<ol>
<li>打开加密文件得到数据 ECDSA(AK) 和 AES(Data)</li>
<li>使用对应的 ECDSA 私钥解密 ECDSA(AK) 得到 AK</li>
<li>使用 AK 进行 AES 解密 AES(Data) 得到 Data</li>
<li>将 Data 写入文件，即为原始文件</li>
</ol>
<p>这样有几个好处：</p>
<ol>
<li>利用了非对称加密的特性: 速度快，密文增幅小</li>
<li>密文仅自己可以见，因为加密时使用的公钥进行的加密</li>
</ol>
<p>上述步骤不能直接使用在数据需要分享的情况下，因为数据使用了公钥进行加密，解密时需要对应的私钥。</p>
<p>未来需要增加分享功能时，我们可提供功能，使得用户可以用他所期望的数据接收方的公钥、来使用上述步骤加密数据，数据接收方得到数据后，按上述的步骤进行解密即可。</p>

    <a href="/"> >> Home</a>
  </main>
</div>
    <footer>
      
<script>
(function() {
  function center_el(tagName) {
    var tags = document.getElementsByTagName(tagName), i, tag;
    for (i = 0; i < tags.length; i++) {
      tag = tags[i];
      var parent = tag.parentElement;
      
      if (parent.childNodes.length === 1) {
        
        if (parent.nodeName === 'A') {
          parent = parent.parentElement;
          if (parent.childNodes.length != 1) continue;
        }
        if (parent.nodeName === 'P') parent.style.textAlign = 'center';
      }
    }
  }
  var tagNames = ['img', 'embed', 'object'];
  for (var i = 0; i < tagNames.length; i++) {
    center_el(tagNames[i]);
  }
})();
</script>

      
      <hr/>
      <a href="https://github.com/hsiaosiyuan0">GitHub</a>
      
    </footer>
  </body>
</html>

