<!DOCTYPE html><html><head><title>Go 语言中的 Generic 设计缺陷</title><meta charSet="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1, user-scalable=no, viewport-fit=cover"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prism-themes@1.9.0/themes/prism-one-dark.min.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/plugins/toolbar/prism-toolbar.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/plugins/line-numbers/prism-line-numbers.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/plugins/line-highlight/prism-line-highlight.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/material-icons@0.3.1/iconfont/material-icons.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/material-icons@0.3.1/css/material-icons.min.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3.2.1/dist/style.min.css"/><link rel="stylesheet" href="/outlet__outlets_default_tsx.css"/><link rel="stylesheet" href="/shared-outlets_index_scss.css"/><link rel="stylesheet" href="/pages/post.css"/></head><body><div id="__gadget__"><div><div class="" style="position:fixed;top:0;left:0;height:2px;background:transparent;z-index:99999999999;width:100%"><div style="height:100%;background:#2998ff;transition:all 500ms ease;width:0%"><div style="box-shadow:0 0 10px #2998ff, 0 0 10px #2998ff;width:5%;opacity:1;position:absolute;height:100%;transition:all 500ms ease;transform:rotate(3deg) translate(0px, -4px);left:-10rem"></div></div></div><div class="_3k0uOgdSRfNa0MZs6QS7ku"><div class="_1G63502GZaEXBXykcWz6cX">The hard ways</div><div style="padding-right:20px"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><div class="_3HRY5_KLp8kngNq9437Zqi"><a href="/sitemap.html">all</a></div></div><div class="Z_a6ax5LrTSVASNRR2aN6 _11dH37BK8JkWofQgbOzM4L"><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><div class="_15sI_H5F3ci3xYIfWDB4vZ"><i class="mi mi-arrow-drop-down"></i><span>v8</span></div><ul><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/v8/debug-v8-in-vscode.html"><i class=""></i><span>在 VSCode 中调试 v8 源码</span></a><ul></ul></div></li><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/v8/common-data-types.html"><i class=""></i><span>v8 常见数据类型</span></a><ul></ul></div></li></ul></div><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><div class="_15sI_H5F3ci3xYIfWDB4vZ"><i class="mi mi-arrow-drop-down"></i><span>deno</span></div><ul><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/deno/native-plugin.html"><i class=""></i><span>deno native plugin 内部实现机制</span></a><ul></ul></div></li></ul></div><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><div class="_15sI_H5F3ci3xYIfWDB4vZ"><i class="mi mi-arrow-drop-down"></i><span>crypto</span></div><ul><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/crypto/brief-crypto.html"><i class=""></i><span>加密算法调研</span></a><ul></ul></div></li></ul></div><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><div class="_15sI_H5F3ci3xYIfWDB4vZ"><i class="mi mi-arrow-drop-down"></i><span>nodejs</span></div><ul><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/nodejs/Cluster 模块分析.html"><i class=""></i><span>Cluster 模块分析</span></a><ul></ul></div></li><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/nodejs/build-from-source.html"><i class=""></i><span>从源码构建 node.js</span></a><ul></ul></div></li><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/nodejs/node-addon.html"><i class=""></i><span>Node.js 扩展</span></a><ul></ul></div></li><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/nodejs/common-snippet.html"><i class=""></i><span>Node 源码中的常见代码</span></a><ul></ul></div></li><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/nodejs/heap-snapshot.html"><i class=""></i><span>v8 Heapsnapshot 文件解析</span></a><ul></ul></div></li><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/nodejs/libuv.html"><i class=""></i><span>Libuv 之 - 只看这篇是不够的</span></a><ul></ul></div></li><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/nodejs/object-in-v8.html"><i class=""></i><span>Objects in V8</span></a><ul></ul></div></li><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/nodejs/node-on-libuv.html"><i class=""></i><span>Libuv 之上的 Node</span></a><ul></ul></div></li></ul></div><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><div class="_15sI_H5F3ci3xYIfWDB4vZ"><i class="mi mi-arrow-drop-down"></i><span>websocket</span></div><ul><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/websocket/WebSocket 协议 1~4 节.html"><i class=""></i><span>WebSocket 协议 1~4 节</span></a><ul></ul></div></li><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/websocket/WebSocket 协议 5~10 节.html"><i class=""></i><span>WebSocket 协议 5~10 节</span></a><ul></ul></div></li></ul></div><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><div class="_15sI_H5F3ci3xYIfWDB4vZ"><i class="mi mi-arrow-drop-down"></i><span>assembly</span></div><ul><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/assembly/汇编语言学习小结.html"><i class=""></i><span>汇编语言学习小结</span></a><ul></ul></div></li></ul></div><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><div class="_15sI_H5F3ci3xYIfWDB4vZ"><i class="mi mi-arrow-drop-down"></i><span>typescript</span></div><ul><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/typescript/decorator.html"><i class=""></i><span>Decorator in babel and tsc</span></a><ul></ul></div></li></ul></div><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><div class="_15sI_H5F3ci3xYIfWDB4vZ"><i class="mi mi-arrow-drop-down"></i><span>rust</span></div><ul><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/rust/lifetime.html"><i class=""></i><span>Lifetime</span></a><ul></ul></div></li></ul></div><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><div class="_15sI_H5F3ci3xYIfWDB4vZ"><i class="mi mi-arrow-drop-down"></i><span>oop</span></div><ul><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/oop/ioc.html"><i class=""></i><span>Midway 分析</span></a><ul></ul></div></li></ul></div><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><div class="_15sI_H5F3ci3xYIfWDB4vZ"><i class="mi mi-arrow-drop-down"></i><span>php</span></div><ul><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/php/为什么 PHP 不适合长时间运行.html"><i class=""></i><span>为什么 PHP 不适合长时间运行</span></a><ul></ul></div></li></ul></div><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><div class="_15sI_H5F3ci3xYIfWDB4vZ"><i class="mi mi-arrow-drop-down"></i><span>blockchain</span></div><ul><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/blockchain/crypto-conditions 简述.html"><i class=""></i><span>Crypto-conditions 简述</span></a><ul></ul></div></li><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/blockchain/实用拜占庭容错简介.html"><i class=""></i><span>实用拜占庭容错简介</span></a><ul></ul></div></li></ul></div><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><div class="_15sI_H5F3ci3xYIfWDB4vZ"><i class="mi mi-arrow-drop-down"></i><span>browser</span></div><ul><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/browser/浏览器异步加载和同源策略.html"><i class=""></i><span>浏览器异步加载和同源策略</span></a><ul></ul></div></li></ul></div><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><div class="_15sI_H5F3ci3xYIfWDB4vZ"><i class="mi mi-arrow-drop-down"></i><span>cpp</span></div><ul><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/cpp/the-as-if-rule.html"><i class=""></i><span>The as-if rule</span></a><ul></ul></div></li></ul></div><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><div class="_15sI_H5F3ci3xYIfWDB4vZ"><i class="mi mi-arrow-drop-down"></i><span>work</span></div><ul><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/work/parsing-in-practice.html"><i class=""></i><span>Parsing in practice</span></a><ul></ul></div></li></ul></div><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><div class="_15sI_H5F3ci3xYIfWDB4vZ"><i class="mi mi-arrow-drop-down"></i><span>os</span></div><ul><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/os/大小端序.html"><i class=""></i><span>大小端序</span></a><ul></ul></div></li><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/os/UTF-8 编码及检查其完整性.html"><i class=""></i><span>UTF-8 编码及检查其完整性</span></a><ul></ul></div></li><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/os/魔数0x7c00.html"><i class=""></i><span>魔数 0x7c00</span></a><ul></ul></div></li><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/os/字符集和字符编码.html"><i class=""></i><span>字符集和字符编码</span></a><ul></ul></div></li></ul></div><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><div class="_15sI_H5F3ci3xYIfWDB4vZ"><i class="mi mi-arrow-drop-down"></i><span>javascript</span></div><ul><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/javascript/generator function.html"><i class=""></i><span>Generator Function</span></a><ul></ul></div></li><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/javascript/解析 JSON 的成本.html"><i class=""></i><span>解析 JSON 的成本</span></a><ul></ul></div></li><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/javascript/Javascript 内部的字符编码.html"><i class=""></i><span>Javascript 内部的字符编码</span></a><ul></ul></div></li><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/javascript/闭包的作用.html"><i class=""></i><span>闭包的作用</span></a><ul></ul></div></li><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/javascript/闭包是什么.html"><i class=""></i><span>闭包是什么</span></a><ul></ul></div></li></ul></div><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><div class="_15sI_H5F3ci3xYIfWDB4vZ"><i class="mi mi-arrow-drop-down"></i><span>static-analysis</span></div><ul><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/static-analysis/ternjs.html"><i class=""></i><span>使用 Rust 重写 ternjs</span></a><ul></ul></div></li></ul></div><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><div class="_15sI_H5F3ci3xYIfWDB4vZ"><i class="mi mi-arrow-drop-down"></i><span>craft</span></div><ul><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/craft/create_your_own_lang.html"><i class=""></i><span>制作一个属于自己的语言</span></a><ul></ul></div></li></ul></div><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><div class="_15sI_H5F3ci3xYIfWDB4vZ"><i class="mi mi-arrow-drop-down"></i><span>go</span></div><ul><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/go/bad_in_generic_syntax.html"><i class=""></i><span>Go 语言中的 Generic 设计缺陷</span></a><ul></ul></div></li></ul></div><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><div class="_15sI_H5F3ci3xYIfWDB4vZ"><i class="mi mi-arrow-drop-down"></i><span>scratch</span></div><ul><li><div class="_3quX88R9lR5BSdfAKHIoaF _1lO9qEBu6kafjPHlc111Kf"><a class="_15sI_H5F3ci3xYIfWDB4vZ" style="padding-left:15px" href="/post/scratch/初唐四杰.html"><i class=""></i><span>初唐四杰</span></a><ul></ul></div></li></ul></div></div><div class="rWpFqfkPbEcRx8xnnjlEm article line-numbers"><div><div><h1 id="Go语言中的Generic设计缺陷">Go 语言中的 Generic 设计缺陷</h1>
<h2 id="歧义">歧义</h2>
<p>Go 语言终于有了 Generic 实现，可我发现它有个让我需要花时间去习惯的缺陷</p>
<p>比如说，下面这段代码是使用了泛型语法的：</p>
<pre><code class="language-Go">package main

import &quot;fmt&quot;

type Numbers interface {
	int | uint8 | float64
}

func max[T Numbers](a, b T) T {
	if a &gt; b {
		return a
	}
	return b
}

func main() {
	a := 0
	b := 1
	fmt.Println(max(a, b))      // T is inferred by the type of arguments
	fmt.Println(max[int](a, b)) // also we can specify the type explicitly
}
</code></pre>
<blockquote>
<p>点击 <a href="https://Go.dev/play/p/HLi_HJZkTPd?v=Gotip">这里</a> 在线运行</p>
</blockquote>
<p>然后我们再来看下面一段代码：</p>
<pre><code class="language-Go">package main

import &quot;fmt&quot;

type AMap map[string]func(int, int) int

var max = AMap{
	&quot;a&quot;: func(a, b int) int {
		if a &gt; b {
			return a
		}
		return b
	},
}

func main() {
	int := &quot;a&quot;
	a := 0
	b := 1
	fmt.Println(max[int](a, b)) // so, it&#x27;s clear that there is a syntax ambiguous in Go&#x27;s generic impl - the callee `max[int]` can be either indexExpr or `typArgExpr`
}
</code></pre>
<blockquote>
<p>点击 <a href="https://Go.dev/play/p/8S6LqkFwEF1?v=Gotip">这里</a> 在线运行</p>
</blockquote>
<p>我在上面代码的注释里面已经写明了，<code>max[int]()</code> 中的 <code>max[int]</code> 在语法层面是有歧义的：</p>
<ul>
<li>既可以是 indexExpr，表示通过下标 <code>int</code> 访问 <code>max</code> 中的元素</li>
<li>也可以是 typArgExpr，表示显式指定 <code>max</code> 的泛型参数是 <code>int</code></li>
</ul>
<p>接下来我将进一步解释为什么这个歧义是需要花时间去习惯它的</p>
<h2 id="缺陷">缺陷</h2>
<p>编程语言设计的目标之一，就是要尽可能的减少歧义</p>
<p>来看一段关于变量声明的演化史。早年间，变量的类型需要显式地标注：</p>
<pre><code class="language-c">int a = 1
</code></pre>
<p>在这个基础上，甚至衍生出在变量名中带上类型前缀的写法，比如：</p>
<pre><code class="language-c">int iAge = 1
</code></pre>
<p>这种写法的诞生有几个背景原因：</p>
<ul>
<li>在阅读代码时，变量的类型是一个重要的信息</li>
<li>早期静态分析工具受限于个人电脑的速率，大家都直接使用文本编辑器一把梭，那直接通过变量名知道类型就是一个比较绿色快捷的方式了</li>
</ul>
<p>随着编译技术的逐渐成熟，以及个人电脑运行速率的提升，下面的这些写法逐渐被大家接受：</p>
<pre><code class="language-cpp">// cpp
auto a = 1
</code></pre>
<pre><code class="language-rust">// rust
let a = 1
</code></pre>
<p>上面就是常说的类型推导 - 基于赋值表达式中右值的类型，推导出变量的类型。后续在阅读代码时，借助静态分析工具来辅助阅读：</p>
<p><img src="https://www.jetbrains.com/rust/img/screenshots/syntax_highlighting@2x.jpg" alt=""/></p>
<blockquote>
<p>上面中 version 的类型就是有静态分析工具增强后的效果</p>
</blockquote>
<p>上面提到的这段演化史，之所以成立，是因为尽管一些信息在代码中被省略了，但是「变量 a 它依然是变量」这个固有属性是不变的</p>
<p>我们知道有的编程语言中、表示函数调用是不需要括号的，比如对于下面的代码：</p>
<pre><code>a
</code></pre>
<p>如果它既可以表示函数调用 a（如果静态分析得出 a 是函数的话）；也可以表示简单的访问变量 a（尽管可能没什么意义）。你会不会感觉很奇怪</p>
<p>回到上面 Golang 中的 <code>max[int]()</code>，确实静态分析工具（或者编译阶段）可以确切的知道 <code>max</code> 是泛型函数还是 <code>map</code>，但是两种语义之间的差异实在太迥异了，以至于我每次看到这样的代码，都忍不住把鼠标移动上去，看看 IDE 给出的提示信息。当然，前提还得是用 IDE 打开这段代码</p>
<h2 id="解决方案一">解决方案一</h2>
<p>谈到解决方案，首先要了解一下为什么 Go 中使用 <code>F[x]</code> 的形式，而不是 Java，Cpp 之流已经用了很多年的 <code>F&lt;x&gt;</code></p>
<p>原因非常简单，就是 Go 需要保持它的一大核心特点 - 编译特别特别特别快。而 <code>&lt;</code> 引入的歧义，会导致包含 <code>&lt;</code> 的表达式都至少要解析两遍：</p>
<ul>
<li>先按泛型解析一遍，尝试匹配关闭的 <code>&gt;</code></li>
<li>如果找不到关闭的 <code>&gt;</code> 再将 <code>&lt;</code> 作为比较运算符来解析一遍</li>
</ul>
<blockquote>
<p>因为 <code>&lt;</code> 既可以表示泛型参数的开头，也可以表示比较运算符 - 小于号</p>
</blockquote>
<p>不理解也不要紧，总是就是比较慢，与现有的需要保持的核心特点相悖</p>
<p>知道了原因之后，我尝试按下面几个原则来设计新的泛型语法：</p>
<ul>
<li>首先就是需要消除 <code>&gt;</code> 的歧义</li>
<li>尽可能的复用之前的泛型语法</li>
<li>复用的同时，要让新语法引入的内容、尽可能产生较少的噪音</li>
</ul>
<p>基于上面这些原则，我将泛型语法设计成：</p>
<pre><code class="language-Go">func max:&lt;T&gt;(a, b T) T {}

c := max:&lt;int&gt;(a, b)
</code></pre>
<p>可以看到，通过在第一个 <code>&lt;</code> 之前引入了 <code>:</code>，即可满足上面几点需求</p>
<p>具体有两点优势需要再明确一下：</p>
<ul>
<li><code>:</code> 有一个比较通用的语义，可以复用在上述语法中，即 <code>:</code> 右侧的内容为其左侧的内容的补充项。所以咋一看 <code>:&lt;T&gt;</code> 好像有点奇怪，但是将其看为对 <code>max</code> 的补充就会好很多</li>
<li><code>:</code> 本身字符宽度很小，引入的噪音很少，对 eye-parsing 的影响小</li>
</ul>
<p>当然了 <code>:</code> 也是有缺点的，引入了噪音就是其固有缺陷，因为这毕竟是为了方便机器解析而添加的额外设计</p>
<h2 id="解决方案二">解决方案二</h2>
<p>方案一毕竟是我拍脑袋想出来的，没有经过系统的验证。作为补充，方案二取自一个比较成熟的小众语言 <a href="https://nim-lang.org/">nim</a> 的设计</p>
<p>有趣且值得注意的是，nim 中的泛型 和 Go 同样使用了 <code>F[x]</code> 的形式，那他们之间的对比就更加明显</p>
<p>来看一下 nim 的语法设计是如何处理前文提到的歧义的：</p>
<pre><code class="language-nim">proc foo[T](i: T) =
  discard

var i: int

# i.foo[int]() # Error: expression &#x27;foo(i)&#x27; has no type (or is ambiguous)

i.foo[:int]() # Success
</code></pre>
<blockquote>
<p>上述代码取自 <a href="https://nim-lang.org/docs/tut2.html#generics">nim-tutorial</a></p>
</blockquote>
<p>注意 <code>foo[:int]</code> 的部分，真是巧妙的设计（与方案一中提到的几个设计原则不谋而合 :D）</p>
<p>同样是 Go 的 <code>F[x]</code> 形式，nim 的处理显得更加地深思熟虑 - 采用了 <code>:</code> 在消除歧义的同时减少噪音</p>
<p>甚至可以在其仓库中找到具体的 <a href="https://github.com/nim-lang/RFCs/issues/40#generics%20cons">[RFC] guidelines for when to use typedesc vs generics</a>，RFC 中也写明了有考虑到歧义：</p>
<blockquote>
<p>call syntax foo[T](x) ambiguous (generic or array subscript depending on foo) , cf New unambiguous generics syntax (generic arguments syntax) Nim#3502</p>
</blockquote>
<p>Go 的泛型在 nim 之后，没有理由 Go 不知道这样的设计，我考虑了 Go 没有采用 nim 这样的设计的几种情况：</p>
<ul>
<li>新语法影响解析速度？很明显不会，这个语法对解析速度的影响微乎其微</li>
<li>这样的歧义不影响阅读？很明显不是，歧义的两头语义差别迥异</li>
<li>这样的歧义是小概率情况？很明显不是，歧义的两头都是很常见的用法</li>
<li>为消除歧义而引入的新语法让整体语法显得不「简洁」或者「统一」？或许有可能（这里需要脑补下 Go 设计哲学中对「简洁」的定义 - sometimes 简陋，不一定是贬义）</li>
<li>从代码消费方来说，只关注函数的出入参，不必关心（阅读）那些写在函数内部的有歧义的语句；而代码维护者大都会使用包含静态分析工具的集成开发环境，大不了鼠标移动上去的事情？或许有可能</li>
</ul>
<h2 id="Takeaway">Take away</h2>
<p>这篇看上去像是关于语法设计的漫谈，若要是非得总结点什么的话，那就是除了思考的过程之外，没有其他绝对的事情</p></div></div></div><div class="_3a4jt6lr4yLRJnQge009wv"><ul><li><div class="pr9M2Qxu3rP9KbtpZMUZy"><div class="_3BS2IRzowIlPVoY1ThvbNb"><span><a class="" href="#歧义">歧义</a></span></div><ul></ul></div></li><li><div class="pr9M2Qxu3rP9KbtpZMUZy"><div class="_3BS2IRzowIlPVoY1ThvbNb"><span><a class="" href="#缺陷">缺陷</a></span></div><ul></ul></div></li><li><div class="pr9M2Qxu3rP9KbtpZMUZy"><div class="_3BS2IRzowIlPVoY1ThvbNb"><span><a class="" href="#解决方案一">解决方案一</a></span></div><ul></ul></div></li><li><div class="pr9M2Qxu3rP9KbtpZMUZy"><div class="_3BS2IRzowIlPVoY1ThvbNb"><span><a class="" href="#解决方案二">解决方案二</a></span></div><ul></ul></div></li><li><div class="pr9M2Qxu3rP9KbtpZMUZy"><div class="_3BS2IRzowIlPVoY1ThvbNb"><span><a class="" href="#Takeaway">Take away</a></span></div><ul></ul></div></li></ul></div><div class="_1UY_ItV2UTWKutKs5b7NKg">Made with <a target="_blank" href="https://github.com/hsiaosiyuan0/gadget">gadget</a></div></div></div><script src="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/components/prism-core.min.js" data-manual="true"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/components/prism-markup.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/components/prism-clike.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/components/prism-json.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/components/prism-javascript.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/components/prism-jsx.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/components/prism-typescript.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/components/prism-tsx.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/components/prism-bash.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/components/prism-python.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/components/prism-xml-doc.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-docker.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-rust.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-nasm.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-c.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-cpp.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-xml-doc.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/components/prism-go.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/components/prism-nim.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/plugins/toolbar/prism-toolbar.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/plugins/line-numbers/prism-line-numbers.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/plugins/line-highlight/prism-line-highlight.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/plugins/show-language/prism-show-language.min.js"></script><script src="https://cdn.jsdelivr.net/gh/cferdinandi/gumshoe@5.1.1/dist/gumshoe.min.js"></script><script src="https://cdn.jsdelivr.net/npm/react@16.14.0/umd/react.production.min.js"></script><script src="https://cdn.jsdelivr.net/npm/react-dom@16.14.0/umd/react-dom.production.min.js"></script><script src="https://cdn.jsdelivr.net/npm/react@16.14.0/umd/react.production.min.js"></script><script src="https://cdn.jsdelivr.net/npm/react-dom@16.14.0/umd/react-dom.production.min.js"></script><script>window["__gadget__"]={"initialProps":{"data":{"post":{"filename":"bad_in_generic_syntax","rawMeta":{"title":"Go 语言中的 Generic 设计缺陷"},"content":"# Go 语言中的 Generic 设计缺陷\n\n## 歧义\n\nGo 语言终于有了 Generic 实现，可我发现它有个让我需要花时间去习惯的缺陷\n\n比如说，下面这段代码是使用了泛型语法的：\n\n```Go\npackage main\n\nimport \"fmt\"\n\ntype Numbers interface {\n\tint | uint8 | float64\n}\n\nfunc max[T Numbers](a, b T) T {\n\tif a > b {\n\t\treturn a\n\t}\n\treturn b\n}\n\nfunc main() {\n\ta := 0\n\tb := 1\n\tfmt.Println(max(a, b))      // T is inferred by the type of arguments\n\tfmt.Println(max[int](a, b)) // also we can specify the type explicitly\n}\n```\n\n> 点击 [这里](https://Go.dev/play/p/HLi_HJZkTPd?v=Gotip) 在线运行\n\n然后我们再来看下面一段代码：\n\n```Go\npackage main\n\nimport \"fmt\"\n\ntype AMap map[string]func(int, int) int\n\nvar max = AMap{\n\t\"a\": func(a, b int) int {\n\t\tif a > b {\n\t\t\treturn a\n\t\t}\n\t\treturn b\n\t},\n}\n\nfunc main() {\n\tint := \"a\"\n\ta := 0\n\tb := 1\n\tfmt.Println(max[int](a, b)) // so, it's clear that there is a syntax ambiguous in Go's generic impl - the callee `max[int]` can be either indexExpr or `typArgExpr`\n}\n```\n\n> 点击 [这里](https://Go.dev/play/p/8S6LqkFwEF1?v=Gotip) 在线运行\n\n我在上面代码的注释里面已经写明了，`max[int]()` 中的 `max[int]` 在语法层面是有歧义的：\n\n- 既可以是 indexExpr，表示通过下标 `int` 访问 `max` 中的元素\n- 也可以是 typArgExpr，表示显式指定 `max` 的泛型参数是 `int`\n\n接下来我将进一步解释为什么这个歧义是需要花时间去习惯它的\n\n## 缺陷\n\n编程语言设计的目标之一，就是要尽可能的减少歧义\n\n来看一段关于变量声明的演化史。早年间，变量的类型需要显式地标注：\n\n```c\nint a = 1\n```\n\n在这个基础上，甚至衍生出在变量名中带上类型前缀的写法，比如：\n\n```c\nint iAge = 1\n```\n\n这种写法的诞生有几个背景原因：\n\n- 在阅读代码时，变量的类型是一个重要的信息\n- 早期静态分析工具受限于个人电脑的速率，大家都直接使用文本编辑器一把梭，那直接通过变量名知道类型就是一个比较绿色快捷的方式了\n\n随着编译技术的逐渐成熟，以及个人电脑运行速率的提升，下面的这些写法逐渐被大家接受：\n\n```cpp\n// cpp\nauto a = 1\n```\n\n```rust\n// rust\nlet a = 1\n```\n\n上面就是常说的类型推导 - 基于赋值表达式中右值的类型，推导出变量的类型。后续在阅读代码时，借助静态分析工具来辅助阅读：\n\n![](https://www.jetbrains.com/rust/img/screenshots/syntax_highlighting@2x.jpg)\n\n> 上面中 version 的类型就是有静态分析工具增强后的效果\n\n上面提到的这段演化史，之所以成立，是因为尽管一些信息在代码中被省略了，但是「变量 a 它依然是变量」这个固有属性是不变的\n\n我们知道有的编程语言中、表示函数调用是不需要括号的，比如对于下面的代码：\n\n```\na\n```\n\n如果它既可以表示函数调用 a（如果静态分析得出 a 是函数的话）；也可以表示简单的访问变量 a（尽管可能没什么意义）。你会不会感觉很奇怪\n\n回到上面 Golang 中的 `max[int]()`，确实静态分析工具（或者编译阶段）可以确切的知道 `max` 是泛型函数还是 `map`，但是两种语义之间的差异实在太迥异了，以至于我每次看到这样的代码，都忍不住把鼠标移动上去，看看 IDE 给出的提示信息。当然，前提还得是用 IDE 打开这段代码\n\n## 解决方案一\n\n谈到解决方案，首先要了解一下为什么 Go 中使用 `F[x]` 的形式，而不是 Java，Cpp 之流已经用了很多年的 `F<x>`\n\n原因非常简单，就是 Go 需要保持它的一大核心特点 - 编译特别特别特别快。而 `<` 引入的歧义，会导致包含 `<` 的表达式都至少要解析两遍：\n\n- 先按泛型解析一遍，尝试匹配关闭的 `>`\n- 如果找不到关闭的 `>` 再将 `<` 作为比较运算符来解析一遍\n\n> 因为 `<` 既可以表示泛型参数的开头，也可以表示比较运算符 - 小于号\n\n不理解也不要紧，总是就是比较慢，与现有的需要保持的核心特点相悖\n\n知道了原因之后，我尝试按下面几个原则来设计新的泛型语法：\n\n- 首先就是需要消除 `>` 的歧义\n- 尽可能的复用之前的泛型语法\n- 复用的同时，要让新语法引入的内容、尽可能产生较少的噪音\n\n基于上面这些原则，我将泛型语法设计成：\n\n```Go\nfunc max:<T>(a, b T) T {}\n\nc := max:<int>(a, b)\n```\n\n可以看到，通过在第一个 `<` 之前引入了 `:`，即可满足上面几点需求\n\n具体有两点优势需要再明确一下：\n\n- `:` 有一个比较通用的语义，可以复用在上述语法中，即 `:` 右侧的内容为其左侧的内容的补充项。所以咋一看 `:<T>` 好像有点奇怪，但是将其看为对 `max` 的补充就会好很多\n- `:` 本身字符宽度很小，引入的噪音很少，对 eye-parsing 的影响小\n\n当然了 `:` 也是有缺点的，引入了噪音就是其固有缺陷，因为这毕竟是为了方便机器解析而添加的额外设计\n\n## 解决方案二\n\n方案一毕竟是我拍脑袋想出来的，没有经过系统的验证。作为补充，方案二取自一个比较成熟的小众语言 [nim](https://nim-lang.org/) 的设计\n\n有趣且值得注意的是，nim 中的泛型 和 Go 同样使用了 `F[x]` 的形式，那他们之间的对比就更加明显\n\n来看一下 nim 的语法设计是如何处理前文提到的歧义的：\n\n```nim\nproc foo[T](i: T) =\n  discard\n\nvar i: int\n\n# i.foo[int]() # Error: expression 'foo(i)' has no type (or is ambiguous)\n\ni.foo[:int]() # Success\n```\n\n> 上述代码取自 [nim-tutorial](https://nim-lang.org/docs/tut2.html#generics)\n\n注意 `foo[:int]` 的部分，真是巧妙的设计（与方案一中提到的几个设计原则不谋而合 :D）\n\n同样是 Go 的 `F[x]` 形式，nim 的处理显得更加地深思熟虑 - 采用了 `:` 在消除歧义的同时减少噪音\n\n甚至可以在其仓库中找到具体的 [[RFC] guidelines for when to use typedesc vs generics](https://github.com/nim-lang/RFCs/issues/40#generics%20cons)，RFC 中也写明了有考虑到歧义：\n\n> call syntax foo\\[T](x) ambiguous (generic or array subscript depending on foo) , cf New unambiguous generics syntax (generic arguments syntax) Nim#3502\n\nGo 的泛型在 nim 之后，没有理由 Go 不知道这样的设计，我考虑了 Go 没有采用 nim 这样的设计的几种情况：\n\n- 新语法影响解析速度？很明显不会，这个语法对解析速度的影响微乎其微\n- 这样的歧义不影响阅读？很明显不是，歧义的两头语义差别迥异\n- 这样的歧义是小概率情况？很明显不是，歧义的两头都是很常见的用法\n- 为消除歧义而引入的新语法让整体语法显得不「简洁」或者「统一」？或许有可能（这里需要脑补下 Go 设计哲学中对「简洁」的定义 - sometimes 简陋，不一定是贬义）\n- 从代码消费方来说，只关注函数的出入参，不必关心（阅读）那些写在函数内部的有歧义的语句；而代码维护者大都会使用包含静态分析工具的集成开发环境，大不了鼠标移动上去的事情？或许有可能\n\n## Take away\n\n这篇看上去像是关于语法设计的漫谈，若要是非得总结点什么的话，那就是除了思考的过程之外，没有其他绝对的事情\n","slug":"/go/bad_in_generic_syntax","toc":[{"name":"歧义","depth":2,"anchor":"#歧义","children":[]},{"name":"缺陷","depth":2,"anchor":"#缺陷","children":[]},{"name":"解决方案一","depth":2,"anchor":"#解决方案一","children":[]},{"name":"解决方案二","depth":2,"anchor":"#解决方案二","children":[]},{"name":"Take away","depth":2,"anchor":"#Takeaway","children":[]}],"keywords":[],"mtime":1645721048692},"catalog":[{"name":"v8","url":"/post/v8","children":[{"name":"在 VSCode 中调试 v8 源码","url":"/post/v8/debug-v8-in-vscode.html","children":[]},{"name":"v8 常见数据类型","url":"/post/v8/common-data-types.html","children":[]}]},{"name":"deno","url":"/post/deno","children":[{"name":"deno native plugin 内部实现机制","url":"/post/deno/native-plugin.html","children":[]}]},{"name":"crypto","url":"/post/crypto","children":[{"name":"加密算法调研","url":"/post/crypto/brief-crypto.html","children":[]}]},{"name":"nodejs","url":"/post/nodejs","children":[{"name":"Cluster 模块分析","url":"/post/nodejs/Cluster 模块分析.html","children":[]},{"name":"从源码构建 node.js","url":"/post/nodejs/build-from-source.html","children":[]},{"name":"Node.js 扩展","url":"/post/nodejs/node-addon.html","children":[]},{"name":"Node 源码中的常见代码","url":"/post/nodejs/common-snippet.html","children":[]},{"name":"v8 Heapsnapshot 文件解析","url":"/post/nodejs/heap-snapshot.html","children":[]},{"name":"Libuv 之 - 只看这篇是不够的","url":"/post/nodejs/libuv.html","children":[]},{"name":"Objects in V8","url":"/post/nodejs/object-in-v8.html","children":[]},{"name":"Libuv 之上的 Node","url":"/post/nodejs/node-on-libuv.html","children":[]}]},{"name":"websocket","url":"/post/websocket","children":[{"name":"WebSocket 协议 1~4 节","url":"/post/websocket/WebSocket 协议 1~4 节.html","children":[]},{"name":"WebSocket 协议 5~10 节","url":"/post/websocket/WebSocket 协议 5~10 节.html","children":[]}]},{"name":"assembly","url":"/post/assembly","children":[{"name":"汇编语言学习小结","url":"/post/assembly/汇编语言学习小结.html","children":[]}]},{"name":"typescript","url":"/post/typescript","children":[{"name":"Decorator in babel and tsc","url":"/post/typescript/decorator.html","children":[]}]},{"name":"rust","url":"/post/rust","children":[{"name":"Lifetime","url":"/post/rust/lifetime.html","children":[]}]},{"name":"oop","url":"/post/oop","children":[{"name":"Midway 分析","url":"/post/oop/ioc.html","children":[]}]},{"name":"php","url":"/post/php","children":[{"name":"为什么 PHP 不适合长时间运行","url":"/post/php/为什么 PHP 不适合长时间运行.html","children":[]}]},{"name":"blockchain","url":"/post/blockchain","children":[{"name":"Crypto-conditions 简述","url":"/post/blockchain/crypto-conditions 简述.html","children":[]},{"name":"实用拜占庭容错简介","url":"/post/blockchain/实用拜占庭容错简介.html","children":[]}]},{"name":"browser","url":"/post/browser","children":[{"name":"浏览器异步加载和同源策略","url":"/post/browser/浏览器异步加载和同源策略.html","children":[]}]},{"name":"cpp","url":"/post/cpp","children":[{"name":"The as-if rule","url":"/post/cpp/the-as-if-rule.html","children":[]}]},{"name":"work","url":"/post/work","children":[{"name":"Parsing in practice","url":"/post/work/parsing-in-practice.html","children":[]}]},{"name":"os","url":"/post/os","children":[{"name":"大小端序","url":"/post/os/大小端序.html","children":[]},{"name":"UTF-8 编码及检查其完整性","url":"/post/os/UTF-8 编码及检查其完整性.html","children":[]},{"name":"魔数 0x7c00","url":"/post/os/魔数0x7c00.html","children":[]},{"name":"字符集和字符编码","url":"/post/os/字符集和字符编码.html","children":[]}]},{"name":"javascript","url":"/post/javascript","children":[{"name":"Generator Function","url":"/post/javascript/generator function.html","children":[]},{"name":"解析 JSON 的成本","url":"/post/javascript/解析 JSON 的成本.html","children":[]},{"name":"Javascript 内部的字符编码","url":"/post/javascript/Javascript 内部的字符编码.html","children":[]},{"name":"闭包的作用","url":"/post/javascript/闭包的作用.html","children":[]},{"name":"闭包是什么","url":"/post/javascript/闭包是什么.html","children":[]}]},{"name":"static-analysis","url":"/post/static-analysis","children":[{"name":"使用 Rust 重写 ternjs","url":"/post/static-analysis/ternjs.html","children":[]}]},{"name":"craft","url":"/post/craft","children":[{"name":"制作一个属于自己的语言","url":"/post/craft/create_your_own_lang.html","children":[]}]},{"name":"go","url":"/post/go","children":[{"name":"Go 语言中的 Generic 设计缺陷","url":"/post/go/bad_in_generic_syntax.html","children":[]}]},{"name":"scratch","url":"/post/scratch","children":[{"name":"初唐四杰","url":"/post/scratch/初唐四杰.html","children":[]}]}],"title":"The hard ways"}},"currentRoute":{"pattern":"/post","href":{"pathname":"/post"}},"pageModules":{"/index":["/pages/index.js"],"/post":["/pages/post.css","/pages/post.js"],"/sitemap":["/pages/sitemap.css","/pages/sitemap.js"],"/post/*":["/pages/post.css","/pages/post.js"]},"router":{"basename":"/","hash":false,"routes":["/index","/post","/sitemap","/post/*"]}};</script><script crossorigin="anonymous" src="/app.js"></script><script crossorigin="anonymous" src="/foundation.js"></script><script crossorigin="anonymous" src="/lib.js"></script><script crossorigin="anonymous" src="/shared-pages_post_tsx.js"></script><script crossorigin="anonymous" src="/pages/post.js"></script></body></html>